<div class="container">
    <div class="options">
        <p-toolbar>
            <ng-template pTemplate="start">
                <div class="toolbar-buttons">
                    <p-avatar
                        pRipple
                        icon="pi pi-plus"
                        class="secondary hov-p"
                        (click)="btnNew()">
                    </p-avatar>
                    <p-avatar
                        pRipple
                        icon="pi pi-pencil"
                        class="secondary hov-p"
                        (click)="btnEdit()">
                    </p-avatar>
                    <p-avatar
                        pRipple
                        icon="pi pi-minus"
                        class="tertiary hov-p"
                        (click)="btnDell()">
                    </p-avatar>
                </div>
            </ng-template>
            <ng-template pTemplate="end">
                <p-iconField>
                    <p-inputIcon styleClass="pi pi-search"/>
                    <input pInputText placeholder="Buscar Cliente"/>
                </p-iconField>
            </ng-template>
        </p-toolbar>
    </div>
    <div class="list-clients">
        <p-button icon="pi pi-replay" class="primary" size="small" (onClick)="cleamTable()" />
        <p-table 
            #dt
            [value]="clients"
            [metaKeySelection]="true"
            [scrollable]="true"
            [scrollHeight]="'400px'"
            styleClass="p-datatable-striped"
            [(selection)]="selectedClient"
            [selectionMode]="'single'"
            dataKey="id"
            >
            <ng-template pTemplate="header">
                <th pSortableColumn="name">
                    Nome <p-sortIcon field="name"/>
                </th>
                <th>
                    Celular
                </th>
                <th pSortableColumn="rating">
                    Avaliação <p-sortIcon field="rating"/>
                </th>
            </ng-template>
            <ng-template pTemplate="body" let-client>
                <tr [pSelectableRow]="client">
                    <th>{{client.name}}</th>
                    <th>{{client.number}}</th>
                    <th>
                        <p-rating 
                        [(ngModel)]="client.rating"
                        [readonly]="true"
                        [cancel]="false"
                        />
                    </th>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>

<!-- Novo cliente -->
<p-dialog
[(visible)]="newClientV"
[style]="{ 'width': '25vw'}"
[breakpoints]="{ '800px': '90vw'}"
header="Crie um novo cliente:"
[closable]="false">
    <ng-template pTemplate="content">
        <div class="field">
            <input 
                type="text" 
                pInputText 
                placeholder="Nome"
                [(ngModel)]="name">
            <p-inputMask
                mask="(99) 99999-9999"
                [(ngModel)]="number"
                placeholder="(ddd) 00000-0000"/>
            <p-rating
                [(ngModel)]="rating"/>
        </div>
    </ng-template>
    <ng-template pTemplate="footer">
        <div class="btns">
            <p-button
                class="secondary"
                label="Confirmar e criar"
                size="small"
                (onClick)="creatNew()"/>
            <p-button
                class="tertiary"
                label="Cancelar"
                size="small"
                (onClick)="btnNew()"/>
        </div>
    </ng-template>
</p-dialog>

<!-- Editar Cliente -->
<p-dialog
    [closable]="false"
    [(visible)]="editClientV"
    [style]="{ 'width': '25vw'}"
    [breakpoints]="{ '800px': '90vw'}"
>
    <ng-template pTemplate="content">
        <div class="field">
            <input 
                type="text" 
                pInputText 
                [placeholder]="editClient.name"
                [(ngModel)]="name">
            <p-inputMask
                mask="(99) 99999-9999"
                [(ngModel)]="number"
                [placeholder]="editClient.number"/>
            <p-rating
                [(ngModel)]="editClient.rating"/>
        </div>
    </ng-template>
    <ng-template pTemplate="footer">
        <div class="btns">
            <p-button
                class="secondary"
                label="Alterar"
                size="small"
                (onClick)="alterar()"/>
            <p-button
                class="tertiary"
                label="Cancelar"
                size="small"
                (onClick)="cleamTable()"/>
        </div>
    </ng-template>
</p-dialog>

<!-- Excluir Cliente -->
<p-dialog
    header="Tem certeza que quer excluir esse cliente?"
    [closable]="false"
    [(visible)]="dellClientV"
    [style]="{ 'width': '25vw'}"
    [breakpoints]="{ '800px': '90vw'}"
>
    <ng-template pTemplate="content">
        <div class="field">
            <input 
                type="text" 
                pInputText 
                [placeholder]="selectedClient.name"
                [disabled]="true">
            <input
                pInputText
                [placeholder]="selectedClient.number"
                [disabled]="true"/>
            <p-rating
                [disabled]="true"
                [ngModel]="selectedClient.rating"/>
        </div>
    </ng-template>
    <ng-template pTemplate="footer">
        <div class="btns">
            <p-button
                class="secondary"
                label="Alterar"
                size="small"
                (onClick)="dellClient()"/>
            <p-button
                class="tertiary"
                label="Cancelar"
                size="small"
                (onClick)="cleamTable()"/>
        </div>
    </ng-template>
</p-dialog>